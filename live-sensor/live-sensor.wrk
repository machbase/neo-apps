{"data":[{"id":"1708516869147330","contents":"# Schema Setup\r\n- Create Tag & Log Table","height":66,"lineHeight":19,"minimal":true,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1708516879313927","contents":"create tag table if not exists tag (name varchar(32) primary key, time datetime basetime, value double summarized);\r\n\r\ncreate log table if not exists alarm (name varchar(32), time datetime, value double);","height":94,"lineHeight":19,"minimal":false,"type":"sql","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"],["shell","Shell"]],"result":"","status":true,"brief":true},{"id":"1758620619506504","contents":"# Automatic  data loading \r\n- Regist timer for automatic data loading TQL\r\n","height":200,"lineHeight":19,"minimal":true,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"],["shell","Shell"]],"result":"","status":true},{"id":"1758620580760922","contents":"\r\ntimer add --autostart sensor5   \"@every 1s\" \"/neo-apps/live-sensor/insert-auto-sensor-5.tql\";\r\ntimer add --autostart vibration \"@every 1s\" \"/neo-apps/live-sensor/insert-auto-vibration.tql\";\r\ntimer add --autostart alarm     \"@every 1s\" \"/neo-apps/live-sensor/insert-auto-alarm.tql\";\r\ntimer list;\r\n","height":115,"lineHeight":19,"minimal":false,"type":"shell","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"],["shell","Shell"]],"result":"","status":true},{"id":"1708408736084197","contents":"# insert-auto-vibration.tql\n\nInsert vibration data to Machbase Neo on every 1 second","height":200,"lineHeight":19,"minimal":false,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"],["shell","Shell"]],"result":"","status":true},{"id":"1708408675406945","contents":"FAKE(\n    oscillator(\n        freq(2, random() * 30), \n        range('now', '1s', '50ms')) \n)\nPUSHVALUE(0, \"vibration\", \"name\")\nAPPEND(table(\"tag\"))","height":150,"lineHeight":19,"minimal":false,"type":"tql","tqlType":"text","lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1708408901213686","contents":"# insert-auto-sensor-5.tql\n\nInsert 5 sensder data to Machbase Neo on every 1 second","height":66,"lineHeight":19,"minimal":true,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1708408932526992","contents":"FAKE(\n    csv(strSprintf(`TIME,SENSOR1,SENSOR2,SENSOR3,SENSOR4,SENSOR5\n                    %s,%f,%f,%f,%f,%f`, strTime(time('now'), 'DEFAULT','UTC'), \n                    random(), random(),random(), random(),random())))\n\nTRANSPOSE(header(true), fixed(0))\nPUSHVALUE(0, 'TAG-' + strTrimSpace(value(1)), \"name\")\nMAPVALUE(1, parseTime(value(1), 'DEFAULT','UTC'), 'time')\nPOPVALUE(2)\nMAPVALUE(2, parseFloat(value(2)), \"value\")\nAPPEND(table(\"tag\"))","height":238,"lineHeight":19,"minimal":false,"type":"tql","tqlType":"text","lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1708517104105708","contents":"# insert-auto-alarm.tql\r\n```\r\nInsert 6th sensor data into Machbase Neo on every 1 second\r\nAnd, detect the outlier value over than 2.5 whose name is \"TAG-SENSOR6\".\r\nIf so, don't insert the record to tag table. \r\nInstead of it, insert the record into \"alarm\" table.\r\n```","height":200,"lineHeight":19,"minimal":true,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1708517105374226","contents":"FAKE(\r\n    csv(strSprintf(`TIME,SENSOR6\r\n                    %s,%f`, strTime(time('now'), 'DEFAULT','UTC'), \r\n                    random()*3)))\r\n\r\nTRANSPOSE(header(true), fixed(0))\r\nPUSHVALUE(0, 'TAG-' + strTrimSpace(value(1)), \"name\")\r\nMAPVALUE(1, parseTime(value(1), 'DEFAULT','UTC'), 'time')\r\nPOPVALUE(2)\r\nMAPVALUE(2, parseFloat(value(2)), \"value\")\r\n\r\nWHEN((glob(\"TAG-SENSOR6\", value(0)) == true && (value(2) > 2.5)), \r\n      do( value(0), value(1), value(2), {\r\n        ARGS()\r\n        INSERT(\"name\", \"time\", \"value\", table(\"alarm\"))    \r\n        }\r\n      )\r\n    )\r\nFILTER(!(glob(\"TAG-SENSOR6\", value(0)) == true && value(2) > 2.5))\r\n\r\nAPPEND(table(\"tag\"))","height":415,"lineHeight":19,"minimal":false,"type":"tql","tqlType":"text","lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"],["shell","Shell"]],"result":"","status":true}]}